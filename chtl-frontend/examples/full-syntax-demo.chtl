// CHTLå®Œæ•´è¯­æ³•æ¼”ç¤ºæ–‡ä»¶

// æ¨¡å—ä¿¡æ¯ï¼ˆç”¨äºCMODï¼‰
[Info]
{
    name = "chtholly-theme";
    version = "1.0.0";
    description = "ç‚æœµè‰ä¸»é¢˜æ¨¡å— - ä¸–ç•Œä¸Šæœ€å¹¸ç¦çš„å¥³å­©";
    author = "CHTL Team";
    license = "MIT";
    dependencies = "";
    category = "theme";
    minCHTLVersion = "1.0.0";
    maxCHTLVersion = "2.0.0";
}

// å¯¼å‡ºå£°æ˜
[Export]
{
    @Style ChthollyStyle, ChthollyCard, ChthollyButton;
    @Element ChthollyPage, ChthollySection;
    @Var ChthollyColors, ChthollyFonts;
}

// é…ç½®å—
[Configuration]
{
    // åŸºç¡€é…ç½®
    charset = "UTF-8";
    title = "CHTLå®Œæ•´è¯­æ³•æ¼”ç¤º";
    lang = "zh-CN";
    
    // å‘½åé…ç½®
    name {
        // è‡ªåŠ¨IDç”Ÿæˆè§„åˆ™
        id {
            prefix = "chtl";
            style = "kebab-case";
            length = 8;
        }
        
        // è‡ªåŠ¨ç±»åç”Ÿæˆè§„åˆ™  
        class {
            prefix = "chtl";
            style = "kebab-case";
        }
    }
}

// å¯¼å…¥å…¶ä»–èµ„æº
[Import] @Html from "./header.html" as SiteHeader;
[Import] @Style from "./styles/main.css" as MainStyles;
[Import] @JavaScript from "./scripts/utils.js" as UtilsScript;
[Import] @Chtl from "Chtholly";  // å¯¼å…¥CMODæ¨¡å—
[Import] @CJmod from "AnimationExtensions";  // å¯¼å…¥CJMODæ‰©å±•

// å‘½åç©ºé—´
[Namespace] Chtholly
{
    // å‘½åç©ºé—´å†…çš„æ ·å¼æ¨¡æ¿
    [Template] @Style ChthollyStyle {
        .chtholly-theme {
            --primary-color: #ff6b6b;
            --secondary-color: #4ecdc4;
            --text-color: #333;
            --bg-color: #f8f9fa;
        }
        
        & {
            color: var(--text-color);
            background: var(--bg-color);
        }
    }
    
    // å‘½åç©ºé—´å†…çš„å…ƒç´ æ¨¡æ¿
    [Template] @Element ChthollyCard {
        div class="chtholly-card" {
            @local style {
                & {
                    padding: 2rem;
                    border-radius: 12px;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                    transition: transform 0.3s ease;
                }
                
                &:hover {
                    transform: translateY(-4px);
                    box-shadow: 0 8px 12px rgba(0,0,0,0.15);
                }
            }
            
            h3 { "$title" }
            p { "$content" }
        }
    }
}

// è‡ªå®šä¹‰å…ƒç´ 
[Custom] @Element Button {
    button class="btn $style" disabled="$disabled" {
        span class="btn-icon" { "$icon" }
        span class="btn-text" { "$text" }
        
        @local style {
            & {
                padding: 0.75rem 1.5rem;
                border: none;
                border-radius: 6px;
                cursor: pointer;
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
            }
            
            &.primary {
                background: var(--primary-color);
                color: white;
            }
            
            &.secondary {
                background: var(--secondary-color);
                color: white;
            }
            
            &:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
        }
    }
}

// å¸¦ç»§æ‰¿çš„æ¨¡æ¿
[Template] @Element BaseLayout {
    html {
        head {
            meta charset="UTF-8";
            meta name="viewport" content="width=device-width, initial-scale=1.0";
            title { "$pageTitle" }
            @inherit;  // å…è®¸å­æ¨¡æ¿æ·»åŠ å†…å®¹
        }
        body {
            @inherit;  // å…è®¸å­æ¨¡æ¿æ·»åŠ å†…å®¹
        }
    }
}

// ä¸»é¡µé¢å®šä¹‰
[Template] @Element HomePage < BaseLayout {
    @override $pageTitle = "CHTLæ¼”ç¤ºä¸»é¡µ";
    
    @specialize head {
        link rel="stylesheet" href="theme.css";
    }
    
    @specialize body {
        header {
            nav {
                ul {
                    li { a href="#home" { "ä¸»é¡µ" } }
                    li { a href="#about" { "å…³äº" } }
                    li { a href="#contact" { "è”ç³»" } }
                }
            }
        }
        
        main {
            // ä½¿ç”¨å‘½åç©ºé—´ä¸­çš„æ¨¡æ¿
            @Chtholly.ChthollyCard {
                $title = "æ¬¢è¿ä½¿ç”¨CHTL";
                $content = "è¿™æ˜¯ä¸€ä¸ªå±•ç¤ºCHTLæ‰€æœ‰è¯­æ³•ç‰¹æ€§çš„æ¼”ç¤ºæ–‡ä»¶";
            }
            
            // ä½¿ç”¨è‡ªå®šä¹‰å…ƒç´ 
            @Button {
                $style = "primary";
                $icon = "ğŸš€";
                $text = "å¼€å§‹ä½¿ç”¨";
                $disabled = "false";
            }
            
            // æ¡ä»¶æ¸²æŸ“
            @if($showFeatures) {
                section class="features" {
                    h2 { "æ ¸å¿ƒç‰¹æ€§" }
                    
                    // å¾ªç¯æ¸²æŸ“
                    @for(feature in $features) {
                        div class="feature-item" {
                            h3 { "$feature.title" }
                            p { "$feature.description" }
                        }
                    }
                }
            }
        }
        
        // æœ¬åœ°è„šæœ¬ï¼ˆå¸¦ä½œç”¨åŸŸéš”ç¦»ï¼‰
        @local script {
            // ä½¿ç”¨CHTL JSå¢å¼ºè¯­æ³•
            {{.btn}}.listen('click', (e) => {
                console.log('æŒ‰é’®è¢«ç‚¹å‡»äº†');
                
                // ä½¿ç”¨->æ“ä½œç¬¦è¿›è¡Œé“¾å¼è°ƒç”¨
                e.target -> 
                    classList.add('clicked') ->
                    animate({
                        scale: [1, 1.1, 1],
                        duration: 300
                    });
            });
            
            // äº‹ä»¶å§”æ‰˜
            document.delegate('click', '.feature-item', function(e) {
                this.classList.toggle('expanded');
            });
        }
    }
}

// åŸå§‹åµŒå…¥å†…å®¹
[Origin] @Html RawComponent {
    <div class="legacy-component">
        <p>è¿™æ˜¯åŸå§‹HTMLå†…å®¹ï¼Œä¸ä¼šè¢«CHTLå¤„ç†</p>
    </div>
}

[Origin] @Style {
    /* åŸå§‹CSSæ ·å¼ */
    .legacy-component {
        background: #f0f0f0;
        padding: 1rem;
    }
}

[Origin] @JavaScript {
    // åŸå§‹JavaScriptä»£ç 
    console.log('è¿™æ˜¯åŸå§‹JSä»£ç ');
}

// å˜é‡å®šä¹‰
[Var] ChthollyColors {
    primary = "#ff6b6b";
    secondary = "#4ecdc4";
    accent = "#95e1d3";
    dark = "#2c3e50";
    light = "#ecf0f1";
}

// é«˜çº§ç‰¹æ€§æ¼”ç¤º
[Template] @Element AdvancedFeatures {
    div class="advanced" {
        // åˆ é™¤æ“ä½œ
        @delete .unwanted-class;
        @delete #old-id;
        
        // æ’å…¥æ“ä½œ
        @insert before .target {
            div class="inserted-before" { "æ’å…¥çš„å†…å®¹" }
        }
        
        // ç‰¹æ®ŠåŒ–æ“ä½œ
        @specialize .existing-element {
            // ä¿®æ”¹ç°æœ‰å…ƒç´ 
            class += " enhanced";
            data-enhanced = "true";
        }
        
        // çº¦æŸæ“ä½œ
        div class="constrained" {
            @except .excluded {
                // è¿™äº›å†…å®¹ä¸ä¼šåº”ç”¨åˆ°.excludedç±»
                color: red;
            }
        }
    }
}

// å®é™…é¡µé¢å†…å®¹
html {
    head {
        meta charset="UTF-8";
        title { "CHTLå®Œæ•´è¯­æ³•æ¼”ç¤º" }
        
        // åº”ç”¨å…¨å±€æ ·å¼
        style {
            @Chtholly.ChthollyStyle;
            
            body {
                margin: 0;
                padding: 0;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            }
        }
    }
    
    body {
        // ä½¿ç”¨æ¨¡æ¿
        @HomePage {
            $showFeatures = "true";
            $features = [
                { title: "æ¨¡æ¿ç³»ç»Ÿ", description: "å¼ºå¤§çš„æ¨¡æ¿å’Œç»§æ‰¿æœºåˆ¶" },
                { title: "å‘½åç©ºé—´", description: "æ¨¡å—åŒ–çš„ä»£ç ç»„ç»‡" },
                { title: "å¢å¼ºCSS", description: "æ”¯æŒ&ç¬¦å·å’Œæœ¬åœ°æ ·å¼" },
                { title: "å¢å¼ºJS", description: "é€‰æ‹©å™¨è¯­æ³•å’Œé“¾å¼è°ƒç”¨" }
            ];
        }
    }
}